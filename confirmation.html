<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>確認預約資料</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #f1f1f1;
    }
    .container {
      padding: 20px;
      border: 2px solid #ccc;
      border-radius: 10px;
      background-color: #fff;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      width: 100%;
      max-width: 400px;
      text-align: center;
    }
    h2 {
      margin-bottom: 20px;
      color: #333;
    }
    p {
      font-size: 16px;
      margin: 10px 0;
      text-align: left;
      line-height: 1.5;
    }
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      margin: 10px;
      cursor: pointer;
    }
    .confirm {
      background-color: #28a745;
      color: white;
    }
    .confirm:hover {
      background-color: #218838;
    }
    .edit {
      background-color: #ffc107;
      color: white;
    }
    .edit:hover {
      background-color: #e0a800;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>確認您的預約資料</h2>
    <p id="preview"></p>
    <button class="confirm" id="confirm">確定</button>
    <button class="edit" id="edit">返回修改</button>
  </div>

  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    // 獲取 URL 參數
    const urlParams = new URLSearchParams(window.location.search);
    const name = urlParams.get('name');
    const phone = urlParams.get('phone');
    const date = urlParams.get('date');
    const time = urlParams.get('time');
    const services = urlParams.get('services');

    // 預覽預約資料
    document.getElementById('preview').innerHTML = `
      <strong>名字:</strong> ${name}<br>
      <strong>電話:</strong> ${phone}<br>
      <strong>預約日期:</strong> ${date}<br>
      <strong>預約時段:</strong> ${time}<br>
      <strong>預約項目:</strong> ${services}<br>
    `;

    // 確認按鈕事件
    document.getElementById('confirm').addEventListener('click', function () {
      const flexMessage = {
        type: 'flex',
        altText: '預約資料通知',
        contents: {
          type: 'bubble',
          hero: {
            type: 'image',
            url: 'https://via.placeholder.com/1024x512?text=預約確認',
            size: 'full',
            aspectRatio: '20:10',
            aspectMode: 'cover'
          },
          body: {
            type: 'box',
            layout: 'vertical',
            spacing: 'md',
            contents: [
              { type: 'text', text: '預約資料確認', weight: 'bold', size: 'lg', align: 'center', color: '#333333' },
              {
                type: 'box',
                layout: 'vertical',
                margin: 'lg',
                spacing: 'sm',
                contents: [
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '名字', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: name, wrap: true, color: '#666666', size: 'sm', flex: 2 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '電話', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: phone, wrap: true, color: '#666666', size: 'sm', flex: 2 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '日期', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: date, wrap: true, color: '#666666', size: 'sm', flex: 2 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '時段', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: time, wrap: true, color: '#666666', size: 'sm', flex: 2 }
                    ]
                  },
                  {
                    type: 'box',
                    layout: 'baseline',
                    spacing: 'sm',
                    contents: [
                      { type: 'text', text: '項目', color: '#aaaaaa', size: 'sm', flex: 1 },
                      { type: 'text', text: services, wrap: true, color: '#666666', size: 'sm', flex: 2 }
                    ]
                  }
                ]
              }
            ]
          },
          footer: {
            type: 'box',
            layout: 'vertical',
            contents: [
              {
                type: 'button',
                style: 'link',
                height: 'sm',
                action: {
                  type: 'uri',
                  label: '地圖位置',
                  uri: 'https://maps.app.goo.gl/8GQYF3yosEfm8uJa9?g_st=com.google.maps.preview.copy'
                }
              }
            ]
          }
        }
      };

      liff.init({ liffId: '2006300099-OLXDXZlb' })
        .then(() => {
          liff.sendMessages([flexMessage])
            .then(() => {
              alert('預約資料已送出！感謝您的支持！');
              liff.closeWindow();
            })
            .catch(err => console.error('Error sending message:', err));
        })
        .catch(err => console.error('Error initializing LIFF:', err));
    });

    // 返回修改按鈕事件
    document.getElementById('edit').addEventListener('click', function () {
      window.history.back();
    });
  </script>
</body>
</html>
